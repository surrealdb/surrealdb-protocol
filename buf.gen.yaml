version: v2
clean: true

inputs:
  - directory: .

plugins:
  # C
  - local: ./plugins/protoc-gen-c
    out: gen/c
  
  # Rust
  - local: ./plugins/protoc-gen-prost
    out: gen/rust/proto
    opt:
      - btree_map=.
      - bytes=.
      - file_descriptor_set=false
      - enable_type_names=true
  - local: ./plugins/protoc-gen-tonic
    out: gen/rust/proto
  
  # Typescript
  - local: ./plugins/protoc-gen-ts_proto
    out: gen/ts
    strategy: all
    opt:
      - oneof=unions
      - removeEnumPrefix=true
      - forceLong=bigint
      - env=both
      - exportCommonSymbols=true
      - outputEncodeMethods=true
      - outputJsonMethods=true
      - useDate=true
